(this.webpackJsonpotif_app=this.webpackJsonpotif_app||[]).push([[0],{16:function(e,t,n){e.exports=n.p+"static/media/macro.9759e23e.vbs"},21:function(e,t){},31:function(e,t,n){e.exports=n(47)},40:function(e,t){},41:function(e,t){},47:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(11),o=n.n(l),i=n(22),c=n(23),u=n(7),s=n(30),m=n(29),d=n(9),p=n.n(d),f=n(3),h=function(e){return{type:"ADD_FILE",data:e}},E=function(e){return{type:"CHANGE_WARNING_STATE",state:e}},O=n(2),g=n(1);function v(){var e=Object(O.a)(["\n    font-size: 20px;\n    border: 1px solid black;\n    display: inline;\n    cursor:pointer;\n    padding: 5px 10px;\n    margin: 3px;\n    border-radius: 2px;\n\n    :hover {\n        color:gray;\n    }\n"]);return v=function(){return e},e}function y(){var e=Object(O.a)(["\n    display:none;\n"]);return y=function(){return e},e}var b=g.default.input(y()),D=g.default.label(v());function C(){var e=Object(O.a)(["\n    font-size:20px;\n    border: 1 px solid black;\n    border-radius: 2px;\n    padding: 5px 10px;\n    margin: 3px;\n    \n    option:selected {\n        color:gray;\n    }\n\n\n"]);return C=function(){return e},e}var S=g.default.select(C()),T=["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map((function(e){return"."+e})).join(","),F=function(e){for(var t=[],n=p.a.utils.decode_range(e).e.c+1,a=0;a<n;++a)t[a]={name:p.a.utils.encode_col(a),key:a};return t},P=function(e){Object(s.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).handleReportChange=function(e){"report"===e.target.id&&a.setState({report:e.target.value}),"customer"===e.target.id&&a.setState({customer:e.target.value})},a.checkReport=function(){return a.state.file.name.slice(0,8)==="".concat(a.state.customer,"_").concat(a.state.report)?(a.props.changeWarningState(!1),a.handleFile()):(a.props.changeWarningState(!0),null)},a.state={file:{},data:[],cols:[],report:null,customer:null},a.handleFile=a.handleFile.bind(Object(u.a)(a)),a.handleChange=a.handleChange.bind(Object(u.a)(a)),a}return Object(c.a)(n,[{key:"componentDidUpdate",value:function(){this.state}},{key:"handleChange",value:function(e){var t=e.target.files;t&&t[0]&&this.setState({file:t[0]})}},{key:"handleFile",value:function(){var e=this,t=new FileReader,n=!!t.readAsBinaryString;t.onload=function(t){var a=t.target.result,r=p.a.read(a,{type:n?"binary":"array",bookVBA:!0}),l=r.SheetNames[0],o=r.Sheets[l],i=p.a.utils.sheet_to_json(o);i.map((function(t){return t["Report Customer"]=e.state.customer})),i.map((function(t){return t.report=e.state.report})),e.setState({data:i,cols:F(o["!ref"])},(function(){e.props.addFile(e.state.data)}))},n?t.readAsBinaryString(this.state.file):t.readAsArrayBuffer(this.state.file)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement(D,{htmlFor:"file"},"Upload an excel files"),r.a.createElement(b,{type:"file",className:"form-control",id:"file",accept:T,onChange:this.handleChange}),r.a.createElement(S,{name:"report",id:"report",onChange:this.handleReportChange},r.a.createElement("option",{value:""}),r.a.createElement("option",{value:"OPEN"},"OPEN"),r.a.createElement("option",{value:"OTIF"},"OTIF")),r.a.createElement(S,{name:"customer",id:"customer",onChange:this.handleReportChange},r.a.createElement("option",{value:""}),r.a.createElement("option",{value:"CLS"},"CLS"),r.a.createElement("option",{value:"JBL"},"JBL"),r.a.createElement("option",{value:"STK"},"STK")),r.a.createElement(D,{htmlFor:"submit"},"Load File"),r.a.createElement(b,{id:"submit",type:"submit",value:"Load File",onClick:function(){e.checkReport()}}))}}]),n}(a.Component),x=Object(f.b)(null,(function(e){return{addFile:function(t){return e(h(t))},changeWarningState:function(t){return e(E(t))}}}))(P),I=n(15),L=n.n(I),N=function(e,t){return{type:"ADD_DATA",OTIF:e,OPEN:t}};function R(){var e=Object(O.a)(["\n    font-size: 20px;\n    background-color: Transparent;\n    cursor:pointer;\n    padding: 5px 10px;\n    margin: 3px;\n    border: 1px solid black;\n    border-radius: 2px;\n\n    :hover {\n        color:gray;\n    }\n"]);return R=function(){return e},e}var k=g.default.button(R()),B=Object(f.b)((function(e){return{files:e.addExcelFile}}),(function(e){return{addData:function(t,n){return e(N(t,n))}}}))((function(e){var t=e.files,n=e.addData;return r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{style:{position:"absolute",bottom:"20px",right:"0"},onClick:function(){!function(e,t){for(var n=[],a=[],r=function(e){if("string"===typeof e)return e.slice(0,10).split(".").join("/");if("number"===typeof e){var t=new Date(0).getTimezoneOffset(),n=new Date(0,0,e-1,0,-t,0);return"".concat(n.getDate(),"/").concat(n.getMonth()+1,"/").concat(n.getUTCFullYear())}},l=0;l<e.length;l++)e[l].map((function(e){return"OTIF"===e.report?n.push(e):a.push(e)}));n.map((function(e){return"STK"===e["Report Customer"]&&(e["Country ship-to-party"]=e["Country sold-to-party"]),"STK"===e["Report Customer"]&&(e["PO Quantity"]=e["SD Quantity"]),"STK"===e["Report Customer"]&&(e["PO Invoice Quantity"]=e["Billed Quantity"]),"STK"===e["Report Customer"]&&(e["PO first commited delivery date"]=e["Deliv.date last confirm."]),"STK"===e["Report Customer"]&&(e["SD Billing Doc. created"]=e["Billing Date"]),e.Product=e.Material.slice(0,4),e["WW-YYYY"]="".concat(L()(),"-").concat((new Date).getFullYear()),e["SD Billing Doc. created"]=r(e["SD Billing Doc. created"]),e["Billing Date"]=r(e["Billing Date"]),e["PO first commited delivery date"]=r(e["PO first commited delivery date"]),e["Sales Doc. created"]=r(e["Sales Doc. created"]),e["Deliv.date last confirm."]=r(e["Deliv.date last confirm."]),e["Ship-to Pur. Order Date"]=r(e["Ship-to Pur. Order Date"]),e["SO + Line"]="".concat(e["Sales Document"]).concat(e["Item (SD)"]),e["Physical delivery date (CLS&JBL)"]="null",e["OTIF V's 1st Commit"]="null",e["Late Category to 1st Commit"]="null",e["Comments (all)"]="null",e["OTIF V's Cust. Req."]="null",e["Late Category to Customer requested"]="null"})),a.map((function(e){return"STK"===e["Report Customer"]&&(e["Country ship-to-party"]=e["Country sold-to-party"]),"STK"===e["Report Customer"]&&(e["PO Quantity"]=e["SD Quantity"]),"STK"===e["Report Customer"]&&(e["PO Invoice Quantity"]=e["Billed Quantity"]),"STK"===e["Report Customer"]&&(e["PO first commited delivery date"]=e["Deliv.date last confirm."]),"STK"===e["Report Customer"]&&(e["SD Billing Doc. created"]=e["Billing Date"]),e.Product=e.Material.slice(0,4),e["WW-YYYY"]="".concat(L()(),"-").concat((new Date).getFullYear()),e["Deliv.date last confirm."]=r(e["Deliv.date last confirm."]),e["Ship-to Pur. Order Date"]=r(e["Ship-to Pur. Order Date"]),e["SO + Line"]="".concat(e["Sales Document"]).concat(e["Item (SD)"]),e["Billing Date"]=r(e["Billing Date"]),e["SD Billing Doc. created"]=r(e["SD Billing Doc. created"]),e["PO first commited delivery date"]=r(e["PO first commited delivery date"]),e["Physical delivery date (CLS&JBL)"]="null",e["OTIF V's 1st Commit"]="null",e["Late Category to 1st Commit"]="null",e["Comments (all)"]="null",e["OTIF V's Cust. Req."]="null",e["Late Category to Customer requested"]="null"})),t(n,a)}(t,n)}},"Generate report"))}));function _(){var e=Object(O.a)(["\n    \n        display: block;\n        height:25vh;\n        max-height:25vh;\n        overflow: scroll;\n        border: 2px solid black;\n        position:relative;\n\n        & > caption {\n              background-color:#7AB800;\n              display:block;\n              color:#FFF;\n              padding:5px;\n              font-size: 30px;\n              position:relative;\n\n              & > p {\n                display:inline;\n              }\n\n              & > button {\n                position:absolute;\n                top:0;\n                right:0;\n              }\n          }\n\n          & > thead > tr > th {\n              padding: 2px;\n              border-bottom: 1px solid black;\n              position: sticky;\n              top:0;\n              background-color:white;\n            }\n\n            & > tbody >tr > td {\n                padding: 2px;\n                border-bottom: 1px solid black;\n              \n              }\n      \n"]);return _=function(){return e},e}var w=g.default.table(_()),A=n(12),j=function(e){var t=e.report,n=e.name;return r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{onClick:function(){!function(){var e=(new Date).toLocaleDateString(),a=t,r="".concat(n,"_").concat(e);Object(A.a)({data:a,fileName:r,exportType:"csv"})}()}},"Download CSV File"))},K=function(e){var t=e.customer,n=e.file,a=e.name,l=e.report,o=function(){var e=(new Date).toLocaleDateString(),a=function(e,n){switch(l){case"OTIF":case"OPEN":return e.filter((function(e){return e["Report Customer"]===t&&e.report===n?e:null}));case null:return e.filter((function(e){return e["Report Customer"]===t?e:null}));default:return[]}}(n,l),r="".concat(t,"_").concat(l||"COMBINED","_").concat(e);Object(A.a)({data:a,fileName:r,exportType:"csv"})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(k,{style:{width:"300px",textAlign:"left"},onClick:function(){o()}},a))},Y=Object(f.b)((function(e){return{OTIF:e.displayDataReducer[0],OPEN:e.displayDataReducer[1]}}))((function(e){var t=e.OTIF,n=e.OPEN,a=["WW-YYYY","Sales Document","SO + Line","Material","Description","Country ship-to-party","Customer","Sold-to party name","PO Quantity","PO Invoice Quantity","Ship-to Pur. Order Date","PO first commited delivery date","SD Billing Doc. created","Report Customer","Physical delivery date (CLS&JBL)","Physical delivery date","OTIF V's 1st Commit","Late Category to 1st Commit","Comments (all)","OTIF V's Cust. Req.","Late Category to Customer requested","report"],l=function(e,t){for(var n={},a=0;a<t.length;a++)e.hasOwnProperty(t[a])&&(n[t[a]]=e[t[a]]);return n};t=t.map((function(e){return l(e,a)})),n=n.map((function(e){return l(e,a)}));var o=function(e){var t=[],n=[],a=[];for(var l in e[0])t.push(r.a.createElement("th",{style:{textAlign:"left"}},l));for(var o=0;o<e.length;o++){for(var i in e[o])a.push(r.a.createElement("td",{style:{color:"".concat(e[o].Duplicate?"red":"black")}},e[o][i]));n.push(a),a=[]}return{headers:t,tables:n}},i=function(e,t){for(var n=e.concat(t),a=0,r=0;r<n.length;r++){for(var l=0;l<n.length;l++)n[l]["SO + Line"]===n[r]["SO + Line"]&&(a++,n[r].Duplicate=!0);1===a&&(n[r].Duplicate=!1),a=0}return n};return r.a.createElement("div",null,r.a.createElement(w,null,r.a.createElement("caption",null,r.a.createElement("p",null,"Weekly OTIF report"),r.a.createElement(j,{report:t.map((function(e){return l(e,a)})),name:"OTIF"})),r.a.createElement("thead",null,r.a.createElement("tr",null,o(t).headers)),r.a.createElement("tbody",null,o(t).tables.map((function(e,t){return r.a.createElement("tr",{key:t},e)})))),r.a.createElement(w,null,r.a.createElement("caption",null,r.a.createElement("p",null,"Weekly OPEN OTIF report"),r.a.createElement(j,{report:n.map((function(e){return l(e,a)})),name:"OPEN"})),r.a.createElement("thead",null,r.a.createElement("tr",null,o(n).headers)),r.a.createElement("tbody",null,o(n).tables.map((function(e,t){return r.a.createElement("tr",{key:t},e)})))),r.a.createElement(w,null,r.a.createElement("caption",null,r.a.createElement("p",null,"OPEN + OTIF duplicates red"),r.a.createElement(j,{report:i(n,t).map((function(e){return l(e,a)})),name:"OPEN OTIF REMOVED DUPLICATES"})),r.a.createElement("thead",null,r.a.createElement("tr",null,o(i(n,t)).headers)),r.a.createElement("tbody",null,o(i(n,t)).tables.map((function(e,t){return r.a.createElement("tr",{key:t},e)})))),r.a.createElement(K,{name:"Celestica OPEN + OTIF",report:null,customer:"CLS",file:i(n,t).map((function(e){return l(e,a)}))}),r.a.createElement(K,{name:"JABIL OPEN + OTIF",report:null,customer:"JBL",file:i(n,t).map((function(e){return l(e,a)}))}),r.a.createElement(K,{name:"STOCKPORT OPEN + OTIF",report:null,customer:"STK",file:i(n,t).map((function(e){return l(e,a)}))}),r.a.createElement("br",null),r.a.createElement(K,{name:"Celestica OTIF",customer:"CLS",report:"OTIF",file:i(n,t).map((function(e){return l(e,a)}))}),r.a.createElement(K,{name:"JABIL OTIF",customer:"JBL",report:"OTIF",file:i(n,t).map((function(e){return l(e,a)}))}),r.a.createElement(K,{name:"STOCKPORT OTIF",customer:"STK",report:"OTIF",file:i(n,t).map((function(e){return l(e,a)}))}),r.a.createElement("br",null),r.a.createElement(K,{name:"Celestica OPEN",customer:"CLS",report:"OPEN",file:i(n,t).map((function(e){return l(e,a)}))}),r.a.createElement(K,{name:"JABIL OPEN",customer:"JBL",report:"OPEN",file:i(n,t).map((function(e){return l(e,a)}))}),r.a.createElement(K,{name:"STOCKPORT OPEN",customer:"STK",report:"OPEN",file:i(n,t).map((function(e){return l(e,a)}))}),r.a.createElement(B,null))}));function W(){var e=Object(O.a)(["\n    width:100%;\n    // height: 10px;\n    background-color:#7AB800;\n    position: absolute;\n    bottom: 0;\n    left: 0;\n\n"]);return W=function(){return e},e}var J=g.default.footer(W()),V=n(28),Q=n(16),M=n.n(Q);console.log(M.a);var q=function(){return r.a.createElement("a",{style:{paddingLeft:"20px"},href:M.a,download:"Macro.vbs"}," Download Macro Here ")};var z=function(){return r.a.createElement("div",{className:"App",style:{position:"relative",minHeight:"100vh",width:"95%",margin:"0 auto",fontFamily:"Lato"}},r.a.createElement(V.Normalize,null),r.a.createElement(x,null),r.a.createElement(Y,null),r.a.createElement(J,null,r.a.createElement(q,null)))},U=n(5),G=n(8),H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_FILE":return[].concat(Object(G.a)(e),[t.data]);default:return Object(G.a)(e)}},X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[],[]],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_DATA":return[t.OTIF,t.OPEN];default:return Object(G.a)(e)}},Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHANGE_WARNING_STATE":return t.state;default:return e}},$=Object(U.b)({addExcelFile:H,displayDataReducer:X,changeWarningStateReducer:Z}),ee=Object(U.c)($,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__());o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(f.a,{store:ee},r.a.createElement(z,null),null)),document.getElementById("root"))}},[[31,1,2]]]);
//# sourceMappingURL=main.cf45b3fb.chunk.js.map