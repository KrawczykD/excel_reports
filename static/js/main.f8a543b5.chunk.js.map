{"version":3,"sources":["actions/addFileActions.js","components/ExcelLoad.js","actions/addDataAction.js","components/ReportValidationFunction.js","components/DisplayList.css.js","components/DownloadExcelButton.js","components/DisplayList.js","components/Footer.css.js","App.js","reducers/addExcelFile.js","reducers/displayDataReducer.js","reducers/rootReducer.js","index.js"],"names":["addFile","data","type","SheetJSFT","map","x","join","make_cols","refstr","o","C","XLSX","utils","decode_range","e","c","i","name","encode_col","key","ExcelLoad","props","handleReportChange","setState","report","target","value","state","file","cols","handleFile","bind","handleChange","files","this","reader","FileReader","rABS","readAsBinaryString","onload","bstr","result","wb","read","bookVBA","wsname","SheetNames","ws","Sheets","sheet_to_json","unshift","readAsArrayBuffer","htmlFor","className","id","accept","onChange","onClick","Component","connect","dispatch","addData","OTIF","OPEN","addExcelFile","excelData","slice","split","offset","Date","getTimezoneOffset","jsdate","getDate","getMonth","getUTCFullYear","array","item","push","filter","Product","currentWeekNumber","getFullYear","console","log","functionChange","Table","styled","table","Button","date","toLocaleDateString","fileName","exportFromJSON","exportType","handleDownloadExcel","preferedOrder","obj","order","newObject","length","hasOwnProperty","preferredOrderSetup","displayDataReducer","generateTable","headers","tables","property","style","textAlign","noDuplicate","b","findIndex","a","obj2","index","ReportValidationFunction","Footer","footer","App","position","minHeight","width","margin","fontFamily","action","rootReducer","combineReducers","store","createStore","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f8a543b5.chunk.js","sourcesContent":["const addFile = (data)=>{\r\n    return(\r\n        {   \r\n            type:\"ADD_FILE\",\r\n            data:data\r\n        }\r\n    )\r\n}\r\n\r\nexport default addFile;","import React, { Component } from 'react';\r\nimport XLSX from 'xlsx';\r\nimport {connect} from 'react-redux';\r\nimport addFile from '../actions/addFileActions';\r\n\r\nconst SheetJSFT = [\r\n\t\"xlsx\", \"xlsb\", \"xlsm\", \"xls\", \"xml\", \"csv\", \"txt\", \"ods\", \"fods\", \"uos\", \"sylk\", \"dif\", \"dbf\", \"prn\", \"qpw\", \"123\", \"wb*\", \"wq*\", \"html\", \"htm\"\r\n].map(function(x) { return \".\" + x; }).join(\",\");\r\n\r\nexport const make_cols = refstr => {\r\n\tlet o = [], C = XLSX.utils.decode_range(refstr).e.c + 1;\r\n\tfor(var i = 0; i < C; ++i) o[i] = {name:XLSX.utils.encode_col(i), key:i}\r\n\treturn o;\r\n};\r\n \r\nclass ExcelLoad extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      file: {},\r\n      data: [],\r\n      cols: [],\r\n      report: null\r\n    }\r\n    this.handleFile = this.handleFile.bind(this);\r\n    this.handleChange = this.handleChange.bind(this);\r\n  }\r\n \r\n  handleChange(e) {\r\n    const files = e.target.files;\r\n    if (files && files[0]) this.setState({ file: files[0] });\r\n  };\r\n\r\n \r\n  handleFile() {\r\n    /* Boilerplate to set up FileReader */\r\n    const reader = new FileReader();\r\n    const rABS = !!reader.readAsBinaryString;\r\n \r\n    reader.onload = (e) => {\r\n      /* Parse data */\r\n      const bstr = e.target.result;\r\n      const wb = XLSX.read(bstr, { type: rABS ? 'binary' : 'array', bookVBA : true });\r\n      /* Get first worksheet */\r\n      const wsname = wb.SheetNames[0];\r\n      const ws = wb.Sheets[wsname];\r\n      /* Convert array of arrays */\r\n      const data = XLSX.utils.sheet_to_json(ws);\r\n      /*Add to object report type*/\r\n      data.unshift(this.state.report)\r\n      /* Update state */\r\n      this.setState({ data: data, cols: make_cols(ws['!ref']) }, () => {\r\n        // console.log(JSON.stringify(this.state.data, null, 2));\r\n        this.props.addFile(this.state.data)\r\n      });\r\n \r\n    };\r\n \r\n    if (rABS) {\r\n      reader.readAsBinaryString(this.state.file);\r\n    } else {\r\n      reader.readAsArrayBuffer(this.state.file);\r\n    };\r\n  }\r\n\r\n\r\n  handleReportChange = (e)=>{\r\n    this.setState({\r\n      report: e.target.value\r\n    })\r\n  }\r\n\r\n\r\n \r\n  render() {\r\n    return (\r\n        <div>\r\n            <label htmlFor=\"file\">Upload an excel files</label>\r\n            <br />\r\n            <input type=\"file\" className=\"form-control\" id=\"file\" accept={SheetJSFT} onChange={this.handleChange}/>\r\n            <select name=\"report\" id=\"report\" onChange={this.handleReportChange}>\r\n              <option value=\"\"></option>\r\n              <option value=\"OTIF\">OTIF</option>\r\n              <option value=\"OPEN_OTIF\">OPEN OTIF</option>\r\n            </select>\r\n            <input type='submit' value=\"Load File\" onClick={this.handleFile} />\r\n        </div>\r\n      \r\n    )\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch)=>({\r\n    addFile : (data)=> dispatch(addFile(data))\r\n})\r\n\r\n\r\nexport default connect(null,mapDispatchToProps)(ExcelLoad);","const addData = (OTIF , OPEN)=>{\r\n    return(\r\n        {   \r\n            type:\"ADD_DATA\",\r\n            OTIF:OTIF,\r\n            OPEN:OPEN,\r\n        }\r\n    )\r\n}\r\n\r\nexport default addData;","import React from \"react\";\r\nimport {connect} from 'react-redux';\r\nimport currentWeekNumber from'current-week-number';\r\nimport addData from '../actions/addDataAction';\r\n;\r\nconst functionChange = (files , addData)=>{\r\n\r\n    let OTIF = []\r\n    let OPEN = []\r\n\r\n    const excelData = (data)=>{\r\n\r\n        if(typeof(data) === \"string\"){\r\n            return data.slice(0,10).split('.').join('/');\r\n        } else if(typeof(data) === \"number\"){\r\n        //   data represents Jan 1, 1993\r\n       let e0date = new Date(0); // epoch \"zero\" date\r\n       let offset = e0date.getTimezoneOffset(); // tz offset in min\r\n\r\n       // calculate Excel xxx days later, with local tz offset\r\n       let jsdate = new Date(0, 0, data-1, 0, -offset, 0);\r\n\r\n       return `${jsdate.getDate()}/${jsdate.getMonth()+1}/${jsdate.getUTCFullYear()}`;\r\n        }\r\n   }\r\n\r\n    files.map(array=>array[0] === \"OTIF\" ? array.map(item=> OTIF.push(item)) : null)\r\n    files.map(array=>array[0] === \"OPEN_OTIF\" ? array.map(item=> OPEN.push(item)) : null)\r\n\r\n    OTIF = OTIF.filter(item => item !== \"OTIF\" ? item : null )\r\n    OPEN = OPEN.filter(item => item !== \"OPEN_OTIF\" ? item : null )\r\n\r\n  \r\n\r\n    OTIF.map( item => {\r\n        return(\r\n            item.report = \"OTIF\",\r\n            item.Product = item[\"Material\"].slice(0,4),\r\n            item[\"WW-YYYY\"] = `${currentWeekNumber()}-${new Date().getFullYear()}`,\r\n\r\n            item[\"SD Billing Doc. created\"] = excelData(item[\"SD Billing Doc. created\"]),\r\n            item[\"Sales Doc. created\"] = excelData(item[\"Sales Doc. created\"]),\r\n            item[\"Deliv.date last confirm.\"] = excelData(item[\"Deliv.date last confirm.\"]),\r\n            item[\"Ship-to Pur. Order Date\"] = excelData(item[\"Ship-to Pur. Order Date\"]),\r\n            item[\"SO + Line\"] = `${item[\"Sales Document\"]}${item[\"Item (SD)\"]}`,\r\n\r\n            item[\"OTIF to Original 1st commit\"] = `null`,\r\n            item[\"1st Commit - Late Category\"] = `null`,\r\n            item[\"Comments (Landis)\"] = `null`,\r\n            console.log(OTIF)\r\n        )\r\n    });\r\n\r\n\r\n\r\n\r\n    OPEN.map(item=> {\r\n        return(\r\n            item.report = \"OPEN_OTIF\",\r\n            item.Product = item[\"Material\"].slice(0,4),\r\n            item[\"WW-YYYY\"] = `${currentWeekNumber()}-${new Date().getFullYear()}`,\r\n\r\n            item[\"Deliv.date last confirm.\"] = excelData(item[\"Deliv.date last confirm.\"]),\r\n            item[\"Ship-to Pur. Order Date\"] = excelData(item[\"Ship-to Pur. Order Date\"]),\r\n            item[\"SO + Line\"] = `${item[\"Sales Document\"]}${item[\"Item (SD)\"]}`,\r\n\r\n            item[\"OTIF to Original 1st commit\"] = `null`,\r\n            item[\"1st Commit - Late Category\"] = `null`,\r\n            item[\"Comments (Landis)\"] = `null`\r\n        )\r\n    });\r\n\r\n  \r\n\r\n    addData( OTIF , OPEN);\r\n}\r\n\r\nconst reportValidationFunction = ({files , addData})=>{\r\n   \r\n\r\n    return(\r\n       <button onClick={()=>{functionChange(files , addData)}}>Generate report</button>\r\n \r\n    )\r\n}\r\n\r\n\r\nconst mapStateToProps = state =>({\r\n    files: state.addExcelFile \r\n})\r\n\r\nconst mapDispatchToProps = dispatch => ({\r\n    addData : (OTIF , OPEN)=> dispatch(addData(OTIF , OPEN))\r\n})\r\n\r\nexport default connect(mapStateToProps,mapDispatchToProps)(reportValidationFunction);;","import styled from 'styled-components';\r\n\r\nconst Table = styled.table`\r\n\r\nmin-width: 1;\r\nborder: 2px solid black;\r\n\r\n& > tbody {\r\n  display: block;\r\n  max-height: 20vh;\r\n  overflow-y: scroll;\r\n}\r\n\r\n& > thead {\r\n  display: table;\r\n  width: 99%;\r\n  table-layout: fixed;\r\n}\r\n\r\n\r\n& > tbody > tr {\r\n  display: table;\r\n  width: 100%;\r\n  table-layout: fixed;\r\n}\r\n\r\n\r\n& > caption {\r\n    background-color:#7AB800;\r\n    color:#FFF;\r\n    padding:5px;\r\n    font-size: 30px;\r\n}\r\n\r\n& > thead > tr > th {\r\n  padding: 2px;\r\n  border-bottom: 1px solid black;\r\n  width:100%;\r\n}\r\n\r\n\r\n& > tbody >tr > td {\r\n  padding: 2px;\r\n  border-bottom: 1px solid black;\r\n}\r\n\r\n`\r\n\r\nexport default Table;","import React from \"react\";\r\nimport exportFromJSON from 'export-from-json';\r\n\r\nconst Button = ({report , name}) =>{\r\n\r\n    const handleDownloadExcel = () =>{\r\n        const date = new Date().toLocaleDateString();\r\n        const data = report;\r\n        const fileName = `${name}_${date}`;\r\n        const exportType = 'csv';\r\n\r\n        exportFromJSON({ data, fileName, exportType })\r\n}\r\n    return(\r\n        <button onClick={()=>{handleDownloadExcel(report)}}>Download CSV File</button>\r\n    )\r\n}\r\n\r\nexport default Button;","import React from 'react';\r\nimport {connect} from 'react-redux';\r\nimport ReportValidationFunction from './ReportValidationFunction';\r\nimport Table from './DisplayList.css';\r\nimport Button from './DownloadExcelButton';\r\n\r\n\r\nfunction preferedOrder(obj, order) {\r\n        var newObject = {};\r\n        for(var i = 0; i < order.length; i++) {\r\n            if(obj.hasOwnProperty(order[i])) {\r\n                newObject[order[i]] = obj[order[i]];\r\n            }\r\n        }\r\n        return newObject;\r\n        }\r\n    \r\n        const preferredOrderSetup = [\r\n            \"SO + Line\",\r\n            \"WW-YYYY\",\r\n            \"Product\",\r\n            \"Sales Document\",\r\n            \"Item (SD)\",\r\n            \"Sold-to party name\",\r\n            \"SD Quantity\",\r\n            \"Billed Quantity\",\r\n            \"Deliv.date last confirm.\",\r\n            \"OTIF to Original 1st commit\",\r\n            \"1st Commit - Late Category\",\r\n            \"Comments (Landis)\"\r\n        ];\r\n\r\n\r\n\r\n\r\n\r\nconst DisplayList = ({OTIF, OPEN})=> {\r\n\r\n    OTIF = OTIF.map(item=> preferedOrder(item,preferredOrderSetup))\r\n    OPEN = OPEN.map(item=> preferedOrder(item,preferredOrderSetup))\r\n\r\n\r\n    const generateTable = (report)=>{\r\n        let headers = [];\r\n        let tables = [];\r\n        let table = [];\r\n    \r\n        for (const property in report.[0]) {\r\n            headers.push(<th style={{textAlign:\"left\"}}>{property}</th>);\r\n          }\r\n\r\n\r\n\r\n\r\n          for(let i = 0 ; i < report.length ; i++){\r\n            for (const property in report[i]) {\r\n                table.push(<td>{report.[i][property]}</td>);\r\n              }\r\n              tables.push(table);\r\n              table = [];\r\n          }\r\n\r\n\r\n          return({headers , tables})\r\n\r\n    }\r\n\r\n    \r\n\r\n    const noDuplicate = ()=>{\r\n        const compareName = (obj1, obj2)=>{\r\n            return (obj1.[\"SO + Line\"] === obj2.[\"SO + Line\"]);\r\n          }\r\n          \r\n          \r\n          let output = OPEN.filter(b=>{\r\n            let indexFound = OTIF.findIndex(a => compareName(a, b));\r\n            return indexFound === -1;\r\n          })   \r\n\r\n          return output;\r\n    }\r\n            \r\n        return(\r\n        <div>\r\n            <Table>\r\n                <caption>Weekly OTIF report</caption>\r\n                <thead>\r\n                    <tr>\r\n                        {generateTable(OTIF).headers}\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                        {generateTable(OTIF).tables.map((item , index)=><tr key={index}>{item}</tr>)}\r\n                </tbody>\r\n            </Table>\r\n            <Button report={OTIF} name=\"OTIF\"></Button>\r\n            <Table>\r\n                    <caption>Weekly OPEN OTIF report</caption>\r\n                    <thead>\r\n                        <tr>\r\n                            {generateTable(OPEN).headers}\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                            {generateTable(OPEN).tables.map((item , index)=><tr key={index}>{item}</tr>)}\r\n                    </tbody>\r\n            </Table>\r\n            <Button report={OPEN} name=\"OPEN OTIF\"></Button>\r\n            <Table>\r\n                    <caption>OPEN OTIF removed duplicates from OTIF</caption>\r\n                    <thead>\r\n                        <tr>\r\n                            {generateTable(noDuplicate()).headers}\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                            {generateTable(noDuplicate()).tables.map((item , index)=><tr key={index}>{item}</tr>)}\r\n                    </tbody>\r\n            </Table>\r\n            <Button report={OPEN} name=\"OPEN OTIF REMOVED DUPLICATES\"></Button>\r\n            <br/>\r\n            <br/>\r\n            <ReportValidationFunction></ReportValidationFunction>\r\n        </div>\r\n        )\r\n    \r\n}\r\n\r\nconst mapStateToProps = state =>({\r\n    OTIF: state.displayDataReducer[0],\r\n    OPEN: state.displayDataReducer[1]\r\n})\r\n\r\nexport default connect(mapStateToProps)(DisplayList);","import styled from 'styled-components';\r\n\r\nconst Footer = styled.footer`\r\n    width:100%;\r\n    height: 1.5vh;\r\n    background-color:#7AB800;\r\n    position: absolute;\r\n    bottom: 0;\r\n    left: 0;\r\n`\r\n\r\nexport default Footer;","import React from 'react';\nimport ExcelLoads from './components/ExcelLoad';\nimport DisplayList from './components/DisplayList';\nimport Footer from './components/Footer.css';\nimport { Normalize } from 'styled-normalize';\n\n\nfunction App() {\n  return (\n    <div className=\"App\" style={{position:\"relative\" , minHeight:\"100vh\" , width:\"95%\" , margin:\"0 auto\" , fontFamily:\"Lato\"}}>\n      <Normalize/>\n      <ExcelLoads></ExcelLoads>\n      <DisplayList></DisplayList>\n      <Footer></Footer>\n    </div>\n  );\n}\n\nexport default App;\n","const addExcelFile = (state = [] , action)=>{\r\n\r\n    switch(action.type) {\r\n        case \"ADD_FILE\":\r\n            return [...state,action.data]\r\n\r\n    \r\n\r\n        default:\r\n            return [...state]\r\n    }\r\n}\r\n\r\nexport default addExcelFile;\r\n","const displayDataReducer = (state = [[],[]] , action)=>{\r\n    switch(action.type) {\r\n        case \"ADD_DATA\":\r\n            return [action.OTIF , action.OPEN]\r\n\r\n    \r\n\r\n        default:\r\n            return [...state]\r\n    }\r\n}\r\n\r\nexport default displayDataReducer;\r\n","import {combineReducers} from 'redux';\r\nimport addExcelFile from './addExcelFile';\r\nimport displayDataReducer from './displayDataReducer';\r\n\r\nconst rootReducer =  combineReducers({\r\n    addExcelFile,\r\n    displayDataReducer,\r\n})\r\n\r\nexport default rootReducer;","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport {Provider} from 'react-redux';\nimport {createStore} from 'redux';\nimport rootReducer from './reducers/rootReducer';\n\nconst store = createStore(rootReducer)\n\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n\n"],"sourceRoot":""}