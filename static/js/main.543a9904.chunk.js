(this.webpackJsonpotif_app=this.webpackJsonpotif_app||[]).push([[0],{15:function(e,t){},21:function(e,t,n){e.exports=n(38)},31:function(e,t){},32:function(e,t){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(7),i=n.n(l),c=n(16),o=n(17),u=n(3),s=n(20),d=n(19),m=n(5),f=n.n(m),p=n(1),h=function(e){return{type:"ADD_FILE",data:e}},O=["xlsx","xlsb","xlsm","xls","xml","csv","txt","ods","fods","uos","sylk","dif","dbf","prn","qpw","123","wb*","wq*","html","htm"].map((function(e){return"."+e})).join(","),g=function(e){for(var t=[],n=f.a.utils.decode_range(e).e.c+1,a=0;a<n;++a)t[a]={name:f.a.utils.encode_col(a),key:a};return t},E=function(e){Object(s.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(c.a)(this,n),(a=t.call(this,e)).handleReportChange=function(e){a.setState({report:e.target.value})},a.state={file:{},data:[],cols:[],report:null},a.handleFile=a.handleFile.bind(Object(u.a)(a)),a.handleChange=a.handleChange.bind(Object(u.a)(a)),a}return Object(o.a)(n,[{key:"handleChange",value:function(e){var t=e.target.files;t&&t[0]&&this.setState({file:t[0]})}},{key:"handleFile",value:function(){var e=this,t=new FileReader,n=!!t.readAsBinaryString;t.onload=function(t){var a=t.target.result,r=f.a.read(a,{type:n?"binary":"array",bookVBA:!0}),l=r.SheetNames[0],i=r.Sheets[l],c=f.a.utils.sheet_to_json(i);c.unshift(e.state.report),e.setState({data:c,cols:g(i["!ref"])},(function(){e.props.addFile(e.state.data)}))},n?t.readAsBinaryString(this.state.file):t.readAsArrayBuffer(this.state.file)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"file"},"Upload an excel to Process Triggers"),r.a.createElement("br",null),r.a.createElement("input",{type:"file",className:"form-control",id:"file",accept:O,onChange:this.handleChange}),r.a.createElement("select",{name:"report",id:"report",onChange:this.handleReportChange},r.a.createElement("option",{value:""}),r.a.createElement("option",{value:"OTIF"},"OTIF"),r.a.createElement("option",{value:"OPEN_OTIF"},"OPEN OTIF")),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",value:"Process Triggers",onClick:this.handleFile}))}}]),n}(a.Component),v=Object(p.b)(null,(function(e){return{addFile:function(t){return e(h(t))}}}))(E),D=n(12),b=n.n(D),y=function(e,t){return{type:"ADD_DATA",OTIF:e,OPEN:t}},F=Object(p.b)((function(e){return{files:e.addExcelFile}}),(function(e){return{addData:function(t,n){return e(y(t,n))}}}))((function(e){var t=e.files,n=e.addData;return r.a.createElement("button",{onClick:function(){!function(e,t){var n=[],a=[],r=function(e){if("string"===typeof e)return e.slice(0,10).split(".").join("/");if("number"===typeof e){var t=new Date(0).getTimezoneOffset(),n=new Date(0,0,e-1,0,-t,0);return"".concat(n.getDate(),"/").concat(n.getMonth()+1,"/").concat(n.getUTCFullYear())}};e.map((function(e){return"OTIF"===e[0]?e.map((function(e){return n.push(e)})):null})),e.map((function(e){return"OPEN_OTIF"===e[0]?e.map((function(e){return a.push(e)})):null})),n=n.filter((function(e){return"OTIF"!==e?e:null})),a=a.filter((function(e){return"OPEN_OTIF"!==e?e:null})),n.map((function(e){return e.report="OTIF",e.Product=e.Material.slice(0,4),e["WW-YYYY"]="".concat(b()(),"-").concat((new Date).getFullYear()),e["SD Billing Doc. created"]=r(e["SD Billing Doc. created"]),e["Sales Doc. created"]=r(e["Sales Doc. created"]),e["Deliv.date last confirm."]=r(e["Deliv.date last confirm."]),e["Ship-to Pur. Order Date"]=r(e["Ship-to Pur. Order Date"]),e["SO + Line"]="".concat(e["Sales Document"]).concat(e["Item (SD)"]),e["OTIF to Original 1st commit"]="null",e["1st Commit - Late Category"]="null",e["Comments (Landis)"]="null"})),console.log(n),a.map((function(e){return e.report="OPEN_OTIF",e.Product=e.Material.slice(0,4),e["WW-YYYY"]="".concat(b()(),"-").concat((new Date).getFullYear()),e["Deliv.date last confirm."]=r(e["Deliv.date last confirm."]),e["Ship-to Pur. Order Date"]=r(e["Ship-to Pur. Order Date"]),e["SO + Line"]="".concat(e["Sales Document"]).concat(e["Item (SD)"]),e["OTIF to Original 1st commit"]="null",e["1st Commit - Late Category"]="null",e["Comments (Landis)"]="null"})),console.log(n),t(n,a)}(t,n)}},"ChangeFile")}));function S(e,t){for(var n={},a=0;a<t.length;a++)e.hasOwnProperty(t[a])&&(n[t[a]]=e[t[a]]);return n}var I=["SO + Line","WW-YYYY","Product","Sales Document","Item (SD)","Sold-to party name","SD Quantity","Billed Quantity","Deliv.date last confirm.","OTIF to Original 1st commit","1st Commit - Late Category","Comments (Landis)"],T=Object(p.b)((function(e){return{OTIF:e.displayDataReducer[0],OPEN:e.displayDataReducer[1]}}))((function(e){var t=e.OTIF,n=e.OPEN;t=t.map((function(e){return S(e,I)})),n=n.map((function(e){return S(e,I)}));var a=function(e){var t=[],n=[],a=[];for(var l in e[0])t.push(r.a.createElement("th",{style:{textAlign:"left"}},l));for(var i=0;i<e.length;i++){for(var c in e[i])a.push(r.a.createElement("td",null,e[i][c]));n.push(a),a=[]}return{headers:t,tables:n}};return r.a.createElement("div",null,r.a.createElement(F,null),r.a.createElement("table",{style:{width:"100%"}},r.a.createElement("caption",null,"Weekly OTIF report"),r.a.createElement("tr",null,a(t).headers),a(t).tables.map((function(e){return r.a.createElement("tr",null,e)}))),r.a.createElement("table",{style:{width:"100%"}},r.a.createElement("caption",null,"Weekly OPEN OTIF report"),r.a.createElement("tr",null,a(n).headers),a(n).tables.map((function(e){return r.a.createElement("tr",null,e)}))))}));var C=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(v,null),r.a.createElement(T,null))},P=n(2),j=n(4),w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_FILE":return[].concat(Object(j.a)(e),[t.data]);default:return Object(j.a)(e)}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[],[]],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_DATA":return[t.OTIF,t.OPEN];default:return Object(j.a)(e)}},Y=Object(P.b)({addExcelFile:w,displayDataReducer:A}),_=Object(P.c)(Y);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(p.a,{store:_},r.a.createElement(C,null))),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.543a9904.chunk.js.map